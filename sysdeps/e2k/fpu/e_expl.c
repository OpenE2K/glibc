/* Copyright (c) 2016 ZAO "MCST". All rights reserved. */

#include "f2c.h"

/*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                        %
%     ПРОГРАММА  ВЫЧИСЛЯЕТ  ЗНАЧЕНИЕ  ФУНКЦИИ            %
%  F(Х) = ЕХР (Х).  НЕДОПУСТИМЫМ   ЗНАЧЕНИЕМ   АРГУМЕН-  %
%  ТА  ЯВЛЯЕТСЯ  Х > 11356.5234062941439488L ИЛИ         %
%  X < -11398.8053843083006136L.                         %
%                                                        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*/

#define KA6  1.3888402125928659474269e-03L
#define KA5  8.3333407361571271053310e-03L
#define KA4  4.1666666667770658180590e-02L
#define KA3  1.6666666666661140796939e-01L
#define KA2  4.9999999999999999723523e-01L

LD __ieee754_expl (LD X)
{
    _type_long_double_bits arg;
    LD y, yv2, hi;
    LI k, ind;

    arg.value = ldfabs (X);
    if ((arg.twolong.short0 & 0x7fff) == 0x7fff) {    /* X == NaN или Inf */
        if (X != X)
            X = X - X;     /* NaN */
        else if (X < 0)
            X = 0;            /* Inf */
        return X;
    }
    if (X > LD_MAX_LOG)
        return SVID_libm_err (X, 0.0, 206);
    if (X < LD_MIN_LOG)
        return SVID_libm_err (X, 0.0, 207);
    k = (int) (X * LD128ONLN2);
    ind = k & 127;
    hi = (LD) k;
    y = X - hi * LDLN2ON128_hi - hi * LDLN2ON128_lo;
    yv2 = y * y;
    y = KA2 * y * (y + 1 / KA2) + KA4 * yv2 * (yv2 + KA3 / KA4 * y) + yv2 * yv2 * (KA5 * y + KA6 * yv2);
    hi = constexpl[ind];
    arg.value = hi * y + constexpl_lo[ind] + hi;
    k = k >> 7;
#if __iset__ < 4
    if (k < -16382)
        ind = k + 110;
    else
        ind = k;
    arg.twolong.short0 += ind;
    if (k < -16382)
        return arg.value * K2IN110;
    else
        return arg.value;
#else /* __iset__ < 4 */
#pragma asm_inline
    __asm ("fxscalesx %0,%1,%0" : "+r" (arg.value) : "r" (k));
    return arg.value;
#endif /* __iset__ < 4 */
}

strong_alias (__ieee754_expl, __expl_finite)
weak_alias (__ieee754_expl, expl)

/*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*/
/*         КОНСТАНТЫ  ФУНКЦИИ  EXPL                     */
/*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*/
const LD constexpl[]={
  1.00000000000000000000e+00L,     /* 2 ** (  0/128) */
  1.00542990111280282134e+00L,     /* 2 ** (  1/128) */
  1.01088928605170045997e+00L,     /* 2 ** (  2/128) */
  1.01637831491095303798e+00L,     /* 2 ** (  3/128) */
  1.02189714865411667821e+00L,     /* 2 ** (  4/128) */
  1.02744594911876369655e+00L,     /* 2 ** (  5/128) */
  1.03302487902122842249e+00L,     /* 2 ** (  6/128) */
  1.03863410196137879061e+00L,     /* 2 ** (  7/128) */
  1.04427378242741384035e+00L,     /* 2 ** (  8/128) */
  1.04994408580068726610e+00L,     /* 2 ** (  9/128) */
  1.05564517836055715878e+00L,     /* 2 ** ( 10/128) */
  1.06137722728926208100e+00L,     /* 2 ** ( 11/128) */
  1.06714040067682361813e+00L,     /* 2 ** ( 12/128) */
  1.07293486752597555143e+00L,     /* 2 ** ( 13/128) */
  1.07876079775711979374e+00L,     /* 2 ** ( 14/128) */
  1.08461836221330923781e+00L,     /* 2 ** ( 15/128) */
  1.09050773266525765921e+00L,     /* 2 ** ( 16/128) */
  1.09642908181637682339e+00L,     /* 2 ** ( 17/128) */
  1.10238258330784094359e+00L,     /* 2 ** ( 18/128) */
  1.10836841172367863806e+00L,     /* 2 ** ( 19/128) */
  1.11438674259589253629e+00L,     /* 2 ** ( 20/128) */
  1.12043775240960668442e+00L,     /* 2 ** ( 21/128) */
  1.12652161860824189974e+00L,     /* 2 ** ( 22/128) */
  1.13263851959871922803e+00L,     /* 2 ** ( 23/128) */
  1.13878863475669165370e+00L,     /* 2 ** ( 24/128) */
  1.14497214443180421939e+00L,     /* 2 ** ( 25/128) */
  1.15118922995298270584e+00L,     /* 2 ** ( 26/128) */
  1.15744007363375102956e+00L,     /* 2 ** ( 27/128) */
  1.16372485877757751379e+00L,     /* 2 ** ( 28/128) */
  1.17004376968325018808e+00L,     /* 2 ** ( 29/128) */
  1.17639699165028127625e+00L,     /* 2 ** ( 30/128) */
  1.18278471098434102989e+00L,     /* 2 ** ( 31/128) */
  1.18920711500272106669e+00L,     /* 2 ** ( 32/128) */
  1.19566439203982737460e+00L,     /* 2 ** ( 33/128) */
  1.20215673145270314211e+00L,     /* 2 ** ( 34/128) */
  1.20868432362658157733e+00L,     /* 2 ** ( 35/128) */
  1.21524735998046887816e+00L,     /* 2 ** ( 36/128) */
  1.22184603297275751687e+00L,     /* 2 ** ( 37/128) */
  1.22848053610687000571e+00L,     /* 2 ** ( 38/128) */
  1.23515106393693330569e+00L,     /* 2 ** ( 39/128) */
  1.24185781207348404863e+00L,     /* 2 ** ( 40/128) */
  1.24860097718920473662e+00L,     /* 2 ** ( 41/128) */
  1.25538075702469108957e+00L,     /* 2 ** ( 42/128) */
  1.26219735039425070807e+00L,     /* 2 ** ( 43/128) */
  1.26905095719173322260e+00L,     /* 2 ** ( 44/128) */
  1.27594177839639210043e+00L,     /* 2 ** ( 45/128) */
  1.28287001607877828072e+00L,     /* 2 ** ( 46/128) */
  1.28983587340666581219e+00L,     /* 2 ** ( 47/128) */
  1.29683955465100966592e+00L,     /* 2 ** ( 48/128) */
  1.30388126519193589862e+00L,     /* 2 ** ( 49/128) */
  1.31096121152476434196e+00L,     /* 2 ** ( 50/128) */
  1.31807960126606399473e+00L,     /* 2 ** ( 51/128) */
  1.32523664315974129459e+00L,     /* 2 ** ( 52/128) */
  1.33243254708316144930e+00L,     /* 2 ** ( 53/128) */
  1.33966752405330300532e+00L,     /* 2 ** ( 54/128) */
  1.34694178623294583575e+00L,     /* 2 ** ( 55/128) */
  1.35425554693689272827e+00L,     /* 2 ** ( 56/128) */
  1.36160902063822475557e+00L,     /* 2 ** ( 57/128) */
  1.36900242297459061194e+00L,     /* 2 ** ( 58/128) */
  1.37643597075453010025e+00L,     /* 2 ** ( 59/128) */
  1.38390988196383195492e+00L,     /* 2 ** ( 60/128) */
  1.39142437577192618710e+00L,     /* 2 ** ( 61/128) */
  1.39897967253831114018e+00L,     /* 2 ** ( 62/128) */
  1.40657599381901544250e+00L,     /* 2 ** ( 63/128) */
  1.41421356237309504876e+00L,     /* 2 ** ( 64/128) */
  1.42189260216916555984e+00L,     /* 2 ** ( 65/128) */
  1.42961333839197001123e+00L,     /* 2 ** ( 66/128) */
  1.43737599744898232558e+00L,     /* 2 ** ( 67/128) */
  1.44518080697704662003e+00L,     /* 2 ** ( 68/128) */
  1.45302799584905256486e+00L,     /* 2 ** ( 69/128) */
  1.46091779418064698860e+00L,     /* 2 ** ( 70/128) */
  1.46885043333698192688e+00L,     /* 2 ** ( 71/128) */
  1.47682614593949931142e+00L,     /* 2 ** ( 72/128) */
  1.48484516587275250051e+00L,     /* 2 ** ( 73/128) */
  1.49290772829126484921e+00L,     /* 2 ** ( 74/128) */
  1.50101406962642552022e+00L,     /* 2 ** ( 75/128) */
  1.50916442759342273971e+00L,     /* 2 ** ( 76/128) */
  1.51735904119821469885e+00L,     /* 2 ** ( 77/128) */
  1.52559815074453830684e+00L,     /* 2 ** ( 78/128) */
  1.53388199784095600184e+00L,     /* 2 ** ( 79/128) */
  1.54221082540794082359e+00L,     /* 2 ** ( 80/128) */
  1.55058487768499995909e+00L,     /* 2 ** ( 81/128) */
  1.55900440023783696706e+00L,     /* 2 ** ( 82/128) */
  1.56746963996555289304e+00L,     /* 2 ** ( 83/128) */
  1.57598084510788648651e+00L,     /* 2 ** ( 84/128) */
  1.58453826525249373016e+00L,     /* 2 ** ( 85/128) */
  1.59314215134226689794e+00L,     /* 2 ** ( 86/128) */
  1.60179275568269335384e+00L,     /* 2 ** ( 87/128) */
  1.61049033194925430819e+00L,     /* 2 ** ( 88/128) */
  1.61923513519486374928e+00L,     /* 2 ** ( 89/128) */
  1.62802742185734776687e+00L,     /* 2 ** ( 90/128) */
  1.63686744976696448776e+00L,     /* 2 ** ( 91/128) */
  1.64575547815396484451e+00L,     /* 2 ** ( 92/128) */
  1.65469176765619439752e+00L,     /* 2 ** ( 93/128) */
  1.66367658032673643501e+00L,     /* 2 ** ( 94/128) */
  1.67271017964159657363e+00L,     /* 2 ** ( 95/128) */
  1.68179283050742908604e+00L,     /* 2 ** ( 96/128) */
  1.69092479926930518196e+00L,     /* 2 ** ( 97/128) */
  1.70010635371852346950e+00L,     /* 2 ** ( 98/128) */
  1.70933776310046282713e+00L,     /* 2 ** ( 99/128) */
  1.71861929812247791560e+00L,     /* 2 ** (100/128) */
  1.72795123096183756220e+00L,     /* 2 ** (101/128) */
  1.73733383527370624901e+00L,     /* 2 ** (102/128) */
  1.74676738619916894005e+00L,     /* 2 ** (103/128) */
  1.75625216037329948311e+00L,     /* 2 ** (104/128) */
  1.76578843593327282108e+00L,     /* 2 ** (105/128) */
  1.77537649252652125255e+00L,     /* 2 ** (106/128) */
  1.78501661131893498010e+00L,     /* 2 ** (107/128) */
  1.79470907500310718641e+00L,     /* 2 ** (108/128) */
  1.80445416780662388026e+00L,     /* 2 ** (109/128) */
  1.81425217550039875620e+00L,     /* 2 ** (110/128) */
  1.82410338540705331100e+00L,     /* 2 ** (111/128) */
  1.83400808640934246351e+00L,     /* 2 ** (112/128) */
  1.84396656895862592505e+00L,     /* 2 ** (113/128) */
  1.85397912508338556835e+00L,     /* 2 ** (114/128) */
  1.86404604839778904478e+00L,     /* 2 ** (115/128) */
  1.87416763411029990130e+00L,     /* 2 ** (116/128) */
  1.88434417903233444966e+00L,     /* 2 ** (117/128) */
  1.89457598158696564135e+00L,     /* 2 ** (118/128) */
  1.90486334181767420369e+00L,     /* 2 ** (119/128) */
  1.91520656139714729382e+00L,     /* 2 ** (120/128) */
  1.92560594363612492901e+00L,     /* 2 ** (121/128) */
  1.93606179349229445060e+00L,     /* 2 ** (122/128) */
  1.94657441757923328632e+00L,     /* 2 ** (123/128) */
  1.95714412417540026897e+00L,     /* 2 ** (124/128) */
  1.96777122323317577815e+00L,     /* 2 ** (125/128) */
  1.97845602638795096831e+00L,     /* 2 ** (126/128) */
  1.98919884696726635134e+00L      /* 2 ** (127/128) */
};

const LD constexpl_lo[]={
  1.00000000000000000000e-40L,     /* мл. ч. 2 ** (  0/128) */
  1.57550448201318474656e-20L,     /* мл. ч. 2 ** (  1/128) */
  5.24720286770341876586e-20L,     /* мл. ч. 2 ** (  2/128) */
 -4.21451557677647725678e-20L,     /* мл. ч. 2 ** (  3/128) */
  2.63279656671808645187e-20L,     /* мл. ч. 2 ** (  4/128) */
 -1.27024638661502299208e-20L,     /* мл. ч. 2 ** (  5/128) */
  1.14236666285578364880e-20L,     /* мл. ч. 2 ** (  6/128) */
  6.35775007670693924020e-21L,     /* мл. ч. 2 ** (  7/128) */
 -2.46543537266551585259e-20L,     /* мл. ч. 2 ** (  8/128) */
 -1.54536189819969606999e-20L,     /* мл. ч. 2 ** (  9/128) */
  2.46022627952846971318e-20L,     /* мл. ч. 2 ** ( 10/128) */
 -4.73131880251091760382e-20L,     /* мл. ч. 2 ** ( 11/128) */
  3.97987057774545202189e-20L,     /* мл. ч. 2 ** ( 12/128) */
 -4.49612396595584802785e-20L,     /* мл. ч. 2 ** ( 13/128) */
  3.40903004404255434541e-21L,     /* мл. ч. 2 ** ( 14/128) */
  2.82502158673091422159e-21L,     /* мл. ч. 2 ** ( 15/128) */
 -1.73975128203494811575e-21L,     /* мл. ч. 2 ** ( 16/128) */
 -1.89622678461498811431e-21L,     /* мл. ч. 2 ** ( 17/128) */
 -3.18568670885710493640e-20L,     /* мл. ч. 2 ** ( 18/128) */
 -4.77624804794089270911e-20L,     /* мл. ч. 2 ** ( 19/128) */
  1.93760098472854254904e-20L,     /* мл. ч. 2 ** ( 20/128) */
  5.50520062907190323111e-21L,     /* мл. ч. 2 ** ( 21/128) */
  5.05441776445557337843e-20L,     /* мл. ч. 2 ** ( 22/128) */
 -4.40832899365820579177e-20L,     /* мл. ч. 2 ** ( 23/128) */
  6.70818194561137685982e-21L,     /* мл. ч. 2 ** ( 24/128) */
  9.04593932051698222170e-21L,     /* мл. ч. 2 ** ( 25/128) */
 -1.89629859268599374845e-20L,     /* мл. ч. 2 ** ( 26/128) */
  5.11106119354747094519e-20L,     /* мл. ч. 2 ** ( 27/128) */
  1.97116805026292371249e-20L,     /* мл. ч. 2 ** ( 28/128) */
 -4.60050856464715656563e-21L,     /* мл. ч. 2 ** ( 29/128) */
  3.08813109229610657429e-20L,     /* мл. ч. 2 ** ( 30/128) */
  3.40834514965983919989e-20L,     /* мл. ч. 2 ** ( 31/128) */
  2.99325844384495372874e-20L,     /* мл. ч. 2 ** ( 32/128) */
 -2.09758430676735662859e-20L,     /* мл. ч. 2 ** ( 33/128) */
 -1.17781808384132075897e-20L,     /* мл. ч. 2 ** ( 34/128) */
  2.07957025752509244740e-20L,     /* мл. ч. 2 ** ( 35/128) */
 -3.95324630955112363710e-20L,     /* мл. ч. 2 ** ( 36/128) */
  3.31805723039740177354e-20L,     /* мл. ч. 2 ** ( 37/128) */
 -1.42782945289713582855e-20L,     /* мл. ч. 2 ** ( 38/128) */
  4.12067483624337667817e-22L,     /* мл. ч. 2 ** ( 39/128) */
 -4.04174985073250611747e-20L,     /* мл. ч. 2 ** ( 40/128) */
 -1.90444682420071468521e-21L,     /* мл. ч. 2 ** ( 41/128) */
  1.06636481132490723180e-20L,     /* мл. ч. 2 ** ( 42/128) */
 -5.33071761501362234701e-20L,     /* мл. ч. 2 ** ( 43/128) */
 -4.25732998715749897886e-20L,     /* мл. ч. 2 ** ( 44/128) */
 -5.01963402807477943255e-20L,     /* мл. ч. 2 ** ( 45/128) */
  5.55485716464039447180e-21L,     /* мл. ч. 2 ** ( 46/128) */
  4.58960789218025694307e-20L,     /* мл. ч. 2 ** ( 47/128) */
  1.21719587275113961096e-20L,     /* мл. ч. 2 ** ( 48/128) */
 -4.25773816645410761942e-20L,     /* мл. ч. 2 ** ( 49/128) */
 -4.11775366541452310242e-20L,     /* мл. ч. 2 ** ( 50/128) */
 -4.41889954706618017381e-20L,     /* мл. ч. 2 ** ( 51/128) */
  3.56252532287040954660e-20L,     /* мл. ч. 2 ** ( 52/128) */
  5.00560148998204024215e-20L,     /* мл. ч. 2 ** ( 53/128) */
  4.29871527603041534402e-20L,     /* мл. ч. 2 ** ( 54/128) */
  3.98464897273074975626e-20L,     /* мл. ч. 2 ** ( 55/128) */
  3.11295515590774905887e-20L,     /* мл. ч. 2 ** ( 56/128) */
  1.59046197909618383215e-20L,     /* мл. ч. 2 ** ( 57/128) */
 -1.39130737786596915229e-20L,     /* мл. ч. 2 ** ( 58/128) */
 -3.06311886399293763224e-20L,     /* мл. ч. 2 ** ( 59/128) */
 -5.09010248523856117297e-20L,     /* мл. ч. 2 ** ( 60/128) */
  5.26097607034585784166e-20L,     /* мл. ч. 2 ** ( 61/128) */
  2.66006089510166175859e-20L,     /* мл. ч. 2 ** ( 62/128) */
 -1.23993090193568256420e-20L,     /* мл. ч. 2 ** ( 63/128) */
  3.79006511778650473707e-20L,     /* мл. ч. 2 ** ( 64/128) */
 -3.16367631047777401587e-20L,     /* мл. ч. 2 ** ( 65/128) */
  3.00162553544403830640e-21L,     /* мл. ч. 2 ** ( 66/128) */
  2.67041277620051466397e-20L,     /* мл. ч. 2 ** ( 67/128) */
  1.16592624056987814731e-20L,     /* мл. ч. 2 ** ( 68/128) */
 -1.15103004836700677888e-20L,     /* мл. ч. 2 ** ( 69/128) */
  4.94804567484164220448e-20L,     /* мл. ч. 2 ** ( 70/128) */
 -1.73621057816240648655e-20L,     /* мл. ч. 2 ** ( 71/128) */
 -3.70558321432658188689e-20L,     /* мл. ч. 2 ** ( 72/128) */
  3.11716990156612332388e-20L,     /* мл. ч. 2 ** ( 73/128) */
 -1.01283052760721221668e-20L,     /* мл. ч. 2 ** ( 74/128) */
  4.70958532395149962549e-20L,     /* мл. ч. 2 ** ( 75/128) */
  5.26310037108121919901e-20L,     /* мл. ч. 2 ** ( 76/128) */
 -4.41684727588840954630e-20L,     /* мл. ч. 2 ** ( 77/128) */
  1.39438183501884939220e-20L,     /* мл. ч. 2 ** ( 78/128) */
 -4.38894821783461465425e-20L,     /* мл. ч. 2 ** ( 79/128) */
  2.63288537887325858991e-20L,     /* мл. ч. 2 ** ( 80/128) */
  3.60227378649241022526e-20L,     /* мл. ч. 2 ** ( 81/128) */
 -2.65852861688297280410e-20L,     /* мл. ч. 2 ** ( 82/128) */
  2.06897838684562615119e-20L,     /* мл. ч. 2 ** ( 83/128) */
 -5.38362671631121667474e-20L,     /* мл. ч. 2 ** ( 84/128) */
 -3.89183643437241976529e-20L,     /* мл. ч. 2 ** ( 85/128) */
 -4.84316471916978782623e-21L,     /* мл. ч. 2 ** ( 86/128) */
 -5.06933105866967779824e-20L,     /* мл. ч. 2 ** ( 87/128) */
 -1.26169628716122801598e-20L,     /* мл. ч. 2 ** ( 88/128) */
  1.62322252588568304580e-20L,     /* мл. ч. 2 ** ( 89/128) */
 -1.74363702181144719646e-20L,     /* мл. ч. 2 ** ( 90/128) */
  4.89646672794497496578e-21L,     /* мл. ч. 2 ** ( 91/128) */
  7.68377339838732804887e-21L,     /* мл. ч. 2 ** ( 92/128) */
  4.73698979989380009731e-20L,     /* мл. ч. 2 ** ( 93/128) */
  3.77490011681082490268e-20L,     /* мл. ч. 2 ** ( 94/128) */
 -1.49499354776576145951e-20L,     /* мл. ч. 2 ** ( 95/128) */
  2.44159659108349977269e-20L,     /* мл. ч. 2 ** ( 96/128) */
  1.41190417581957804115e-20L,     /* мл. ч. 2 ** ( 97/128) */
 -6.23294004967049044145e-22L,     /* мл. ч. 2 ** ( 98/128) */
 -2.53968701484078459380e-20L,     /* мл. ч. 2 ** ( 99/128) */
  2.60529668710165171978e-20L,     /* мл. ч. 2 ** (100/128) */
  4.30368985156152020666e-20L,     /* мл. ч. 2 ** (101/128) */
 -1.48104436471575034023e-20L,     /* мл. ч. 2 ** (102/128) */
  2.99506754868957747208e-20L,     /* мл. ч. 2 ** (103/128) */
  2.68764563446337005622e-21L,     /* мл. ч. 2 ** (104/128) */
 -3.76994771518564969611e-20L,     /* мл. ч. 2 ** (105/128) */
  4.12913717530432143036e-21L,     /* мл. ч. 2 ** (106/128) */
  4.31494889857018766652e-20L,     /* мл. ч. 2 ** (107/128) */
  1.28619301556136265883e-20L,     /* мл. ч. 2 ** (108/128) */
  5.26397568739327276084e-20L,     /* мл. ч. 2 ** (109/128) */
  5.12844794629139525729e-20L,     /* мл. ч. 2 ** (110/128) */
 -6.53506087906479804891e-21L,     /* мл. ч. 2 ** (111/128) */
 -2.02535838545128930642e-20L,     /* мл. ч. 2 ** (112/128) */
  1.68587827059959400390e-20L,     /* мл. ч. 2 ** (113/128) */
  4.06793835805409455943e-20L,     /* мл. ч. 2 ** (114/128) */
  3.17358053297943417579e-20L,     /* мл. ч. 2 ** (115/128) */
  2.97886153895801050661e-20L,     /* мл. ч. 2 ** (116/128) */
  2.50136363126720934125e-20L,     /* мл. ч. 2 ** (117/128) */
 -9.91286387954078848228e-21L,     /* мл. ч. 2 ** (118/128) */
 -3.88158536931358960100e-20L,     /* мл. ч. 2 ** (119/128) */
  5.23523416198050749593e-20L,     /* мл. ч. 2 ** (120/128) */
 -5.35591317623072807316e-20L,     /* мл. ч. 2 ** (121/128) */
 -6.07431105309142758273e-22L,     /* мл. ч. 2 ** (122/128) */
  2.23270632490974324239e-20L,     /* мл. ч. 2 ** (123/128) */
  5.25784630640104640349e-20L,     /* мл. ч. 2 ** (124/128) */
 -4.16535119398391976511e-20L,     /* мл. ч. 2 ** (125/128) */
 -5.19879244311484283136e-20L,     /* мл. ч. 2 ** (126/128) */
 -3.48038725206338977385e-20L      /* мл. ч. 2 ** (127/128) */
};
