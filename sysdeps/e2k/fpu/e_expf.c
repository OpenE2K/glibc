/* Copyright (c) 2016-2018 ZAO "MCST". All rights reserved. */

#include "f2c.h"
#include <e2kintrin.h>

/*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                        %
%     πςοηςαννα  χωώισμρετ  ϊξαώεξιε  ζυξλγιι            %
%  F(θ) = εθς (θ).  ξεδοπυστινων   ϊξαώεξιεν   αςηυνεξ-  %
%  τα  ρχμρετσρ  θ > 88.7228394 ιμι X < -103.972076 .    %
%                                                        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*/

#define KA2 3.66556671660783833261e-06
#define KA1 2.70760782821392980564e-03
#define K256ONLN2 369.3299304675746271

FL __ieee754_expf (FL X)
{
    _type_float_bits arg;
    _type_double_bits rez;
    DB y;
    long k;

    arg.value = ffabs (X);
    if (arg.int0 >= 0x7f800000) {       /* X == NaN ΙΜΙ Inf */
        if (X < 0)
            X = 0;
        return X;
    }
    y = K256ONLN2 * (DB) X;
    if ((X > FL_MAX_LOG) || (X < FL_MIN_LOG)) {
        return (FL) SVID_libm_err(X, 0, (X < FL_MIN_LOG) ? 107 : 106);
    }
    k = (int) y;
#if __iset__ <= 2
    y -= (DB) k;
#else /*  __iset__ <= 2 */
    DB ym;
#pragma asm_inline
    __asm ("fdtoifd 0x3,%1,%0" : "=r" (ym): "r" (y));
    y -= ym;
#endif /*  __iset__ <= 2 */
    rez.value = constnexp[k & 255];
    rez.llong = __builtin_e2k_paddd (rez.llong, ((LL) (k >> 8)) << 52);
#if __iset__ >= 6
    _type_double_bits lres;
    lres.value = KA2 * y * (y + KA1 / KA2);
    lres.llong = __builtin_e2k_fmad (lres.llong, rez.llong, rez.llong);
    return (FL) lres.value;
#else /* __iset__ < 6 */
    return (FL) (KA2 * y * (y + KA1 / KA2) * rez.value + rez.value);
#endif /* __iset__ < 6 */
}

strong_alias (__ieee754_expf, __expf_finite)
weak_alias (__ieee754_expf, expf)

/*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*/
/*         λοξσταξτω  ζυξλγιι  EXPF                     */
/*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*/
const DB constnexp[]={
 1.0000000000000000000e+00,     /* 2 ** (  0/256) */
 1.0027112750502024854e+00,     /* 2 ** (  1/256) */
 1.0054299011128028214e+00,     /* 2 ** (  2/256) */
 1.0081558981184175158e+00,     /* 2 ** (  3/256) */
 1.0108892860517004600e+00,     /* 2 ** (  4/256) */
 1.0136300849514894388e+00,     /* 2 ** (  5/256) */
 1.0163783149109530379e+00,     /* 2 ** (  6/256) */
 1.0191339960777379497e+00,     /* 2 ** (  7/256) */
 1.0218971486541166782e+00,     /* 2 ** (  8/256) */
 1.0246677928971356451e+00,     /* 2 ** (  9/256) */
 1.0274459491187636965e+00,     /* 2 ** ( 10/256) */
 1.0302316376860410129e+00,     /* 2 ** ( 11/256) */
 1.0330248790212284225e+00,     /* 2 ** ( 12/256) */
 1.0358256936019571200e+00,     /* 2 ** ( 13/256) */
 1.0386341019613787906e+00,     /* 2 ** ( 14/256) */
 1.0414501246883161413e+00,     /* 2 ** ( 15/256) */
 1.0442737824274138403e+00,     /* 2 ** ( 16/256) */
 1.0471050958792898661e+00,     /* 2 ** ( 17/256) */
 1.0499440858006872661e+00,     /* 2 ** ( 18/256) */
 1.0527907730046263271e+00,     /* 2 ** ( 19/256) */
 1.0556451783605571588e+00,     /* 2 ** ( 20/256) */
 1.0585073227945126901e+00,     /* 2 ** ( 21/256) */
 1.0613772272892620810e+00,     /* 2 ** ( 22/256) */
 1.0642549128844645498e+00,     /* 2 ** ( 23/256) */
 1.0671404006768236182e+00,     /* 2 ** ( 24/256) */
 1.0700337118202417735e+00,     /* 2 ** ( 25/256) */
 1.0729348675259755514e+00,     /* 2 ** ( 26/256) */
 1.0758438890627910378e+00,     /* 2 ** ( 27/256) */
 1.0787607977571197937e+00,     /* 2 ** ( 28/256) */
 1.0816856149932152019e+00,     /* 2 ** ( 29/256) */
 1.0846183622133092378e+00,     /* 2 ** ( 30/256) */
 1.0875590609177696653e+00,     /* 2 ** ( 31/256) */
 1.0905077326652576592e+00,     /* 2 ** ( 32/256) */
 1.0934643990728858542e+00,     /* 2 ** ( 33/256) */
 1.0964290818163768234e+00,     /* 2 ** ( 34/256) */
 1.0994018026302219855e+00,     /* 2 ** ( 35/256) */
 1.1023825833078409436e+00,     /* 2 ** ( 36/256) */
 1.1053714457017412556e+00,     /* 2 ** ( 37/256) */
 1.1083684117236786380e+00,     /* 2 ** ( 38/256) */
 1.1113735033448176039e+00,     /* 2 ** ( 39/256) */
 1.1143867425958925363e+00,     /* 2 ** ( 40/256) */
 1.1174081515673691991e+00,     /* 2 ** ( 41/256) */
 1.1204377524096066844e+00,     /* 2 ** ( 42/256) */
 1.1234755673330198007e+00,     /* 2 ** ( 43/256) */
 1.1265216186082418998e+00,     /* 2 ** ( 44/256) */
 1.1295759285662881460e+00,     /* 2 ** ( 45/256) */
 1.1326385195987192280e+00,     /* 2 ** ( 46/256) */
 1.1357094141578055142e+00,     /* 2 ** ( 47/256) */
 1.1387886347566916537e+00,     /* 2 ** ( 48/256) */
 1.1418762039695616227e+00,     /* 2 ** ( 49/256) */
 1.1449721444318042194e+00,     /* 2 ** ( 50/256) */
 1.1480764788401790068e+00,     /* 2 ** ( 51/256) */
 1.1511892299529827058e+00,     /* 2 ** ( 52/256) */
 1.1543104205902160395e+00,     /* 2 ** ( 53/256) */
 1.1574400736337510296e+00,     /* 2 ** ( 54/256) */
 1.1605782120274987464e+00,     /* 2 ** ( 55/256) */
 1.1637248587775775138e+00,     /* 2 ** ( 56/256) */
 1.1668800369524815706e+00,     /* 2 ** ( 57/256) */
 1.1700437696832501881e+00,     /* 2 ** ( 58/256) */
 1.1732160801636372475e+00,     /* 2 ** ( 59/256) */
 1.1763969916502812763e+00,     /* 2 ** ( 60/256) */
 1.1795865274628759455e+00,     /* 2 ** ( 61/256) */
 1.1827847109843410299e+00,     /* 2 ** ( 62/256) */
 1.1859915656609938314e+00,     /* 2 ** ( 63/256) */
 1.1892071150027210667e+00,     /* 2 ** ( 64/256) */
 1.1924313825831512221e+00,     /* 2 ** ( 65/256) */
 1.1956643920398273746e+00,     /* 2 ** ( 66/256) */
 1.1989061670743804818e+00,     /* 2 ** ( 67/256) */
 1.2021567314527031421e+00,     /* 2 ** ( 68/256) */
 1.2054161090051238256e+00,     /* 2 ** ( 69/256) */
 1.2086843236265815774e+00,     /* 2 ** ( 70/256) */
 1.2119613992768011945e+00,     /* 2 ** ( 71/256) */
 1.2152473599804688781e+00,     /* 2 ** ( 72/256) */
 1.2185422298274083618e+00,     /* 2 ** ( 73/256) */
 1.2218460329727575169e+00,     /* 2 ** ( 74/256) */
 1.2251587936371454377e+00,     /* 2 ** ( 75/256) */
 1.2284805361068700057e+00,     /* 2 ** ( 76/256) */
 1.2318112847340759359e+00,     /* 2 ** ( 77/256) */
 1.2351510639369333057e+00,     /* 2 ** ( 78/256) */
 1.2384998981998165678e+00,     /* 2 ** ( 79/256) */
 1.2418578120734840486e+00,     /* 2 ** ( 80/256) */
 1.2452248301752579328e+00,     /* 2 ** ( 81/256) */
 1.2486009771892047366e+00,     /* 2 ** ( 82/256) */
 1.2519862778663162701e+00,     /* 2 ** ( 83/256) */
 1.2553807570246910896e+00,     /* 2 ** ( 84/256) */
 1.2587844395497164431e+00,     /* 2 ** ( 85/256) */
 1.2621973503942507080e+00,     /* 2 ** ( 86/256) */
 1.2656195145788063242e+00,     /* 2 ** ( 87/256) */
 1.2690509571917332226e+00,     /* 2 ** ( 88/256) */
 1.2724917033894027512e+00,     /* 2 ** ( 89/256) */
 1.2759417783963921004e+00,     /* 2 ** ( 90/256) */
 1.2794012075056692269e+00,     /* 2 ** ( 91/256) */
 1.2828700160787782807e+00,     /* 2 ** ( 92/256) */
 1.2863482295460255336e+00,     /* 2 ** ( 93/256) */
 1.2898358734066658122e+00,     /* 2 ** ( 94/256) */
 1.2933329732290894367e+00,     /* 2 ** ( 95/256) */
 1.2968395546510096659e+00,     /* 2 ** ( 96/256) */
 1.3003556433796506510e+00,     /* 2 ** ( 97/256) */
 1.3038812651919358986e+00,     /* 2 ** ( 98/256) */
 1.3074164459346772448e+00,     /* 2 ** ( 99/256) */
 1.3109612115247643419e+00,     /* 2 ** (100/256) */
 1.3145155879493546585e+00,     /* 2 ** (101/256) */
 1.3180796012660639947e+00,     /* 2 ** (102/256) */
 1.3216532776031575143e+00,     /* 2 ** (103/256) */
 1.3252366431597412946e+00,     /* 2 ** (104/256) */
 1.3288297242059543955e+00,     /* 2 ** (105/256) */
 1.3324325470831614494e+00,     /* 2 ** (106/256) */
 1.3360451382041457734e+00,     /* 2 ** (107/256) */
 1.3396675240533030054e+00,     /* 2 ** (108/256) */
 1.3432997311868352638e+00,     /* 2 ** (109/256) */
 1.3469417862329458358e+00,     /* 2 ** (110/256) */
 1.3505937158920343914e+00,     /* 2 ** (111/256) */
 1.3542555469368927283e+00,     /* 2 ** (112/256) */
 1.3579273062129010465e+00,     /* 2 ** (113/256) */
 1.3616090206382247556e+00,     /* 2 ** (114/256) */
 1.3653007172040118154e+00,     /* 2 ** (115/256) */
 1.3690024229745906119e+00,     /* 2 ** (116/256) */
 1.3727141650876683693e+00,     /* 2 ** (117/256) */
 1.3764359707545301002e+00,     /* 2 ** (118/256) */
 1.3801678672602380956e+00,     /* 2 ** (119/256) */
 1.3839098819638319549e+00,     /* 2 ** (120/256) */
 1.3876620422985291590e+00,     /* 2 ** (121/256) */
 1.3914243757719261871e+00,     /* 2 ** (122/256) */
 1.3951969099662001783e+00,     /* 2 ** (123/256) */
 1.3989796725383111402e+00,     /* 2 ** (124/256) */
 1.4027726912202047064e+00,     /* 2 ** (125/256) */
 1.4065759938190154425e+00,     /* 2 ** (126/256) */
 1.4103896082172707044e+00,     /* 2 ** (127/256) */
 1.4142135623730950488e+00,     /* 2 ** (128/256) */
 1.4180478843204151978e+00,     /* 2 ** (129/256) */
 1.4218926021691655598e+00,     /* 2 ** (130/256) */
 1.4257477441054943068e+00,     /* 2 ** (131/256) */
 1.4296133383919700112e+00,     /* 2 ** (132/256) */
 1.4334894133677888425e+00,     /* 2 ** (133/256) */
 1.4373759974489823256e+00,     /* 2 ** (134/256) */
 1.4412731191286256627e+00,     /* 2 ** (135/256) */
 1.4451808069770466200e+00,     /* 2 ** (136/256) */
 1.4490990896420349805e+00,     /* 2 ** (137/256) */
 1.4530279958490525648e+00,     /* 2 ** (138/256) */
 1.4569675544014438216e+00,     /* 2 ** (139/256) */
 1.4609177941806469887e+00,     /* 2 ** (140/256) */
 1.4648787441464058266e+00,     /* 2 ** (141/256) */
 1.4688504333369819269e+00,     /* 2 ** (142/256) */
 1.4728328908693675950e+00,     /* 2 ** (143/256) */
 1.4768261459394993114e+00,     /* 2 ** (144/256) */
 1.4808302278224717705e+00,     /* 2 ** (145/256) */
 1.4848451658727525005e+00,     /* 2 ** (146/256) */
 1.4888709895243970654e+00,     /* 2 ** (147/256) */
 1.4929077282912648492e+00,     /* 2 ** (148/256) */
 1.4969554117672354268e+00,     /* 2 ** (149/256) */
 1.5010140696264255203e+00,     /* 2 ** (150/256) */
 1.5050837316234065441e+00,     /* 2 ** (151/256) */
 1.5091644275934227398e+00,     /* 2 ** (152/256) */
 1.5132561874526099022e+00,     /* 2 ** (153/256) */
 1.5173590411982146988e+00,     /* 2 ** (154/256) */
 1.5214730189088145835e+00,     /* 2 ** (155/256) */
 1.5255981507445383069e+00,     /* 2 ** (156/256) */
 1.5297344669472870239e+00,     /* 2 ** (157/256) */
 1.5338819978409560018e+00,     /* 2 ** (158/256) */
 1.5380407738316569284e+00,     /* 2 ** (159/256) */
 1.5422108254079408236e+00,     /* 2 ** (160/256) */
 1.5463921831410215549e+00,     /* 2 ** (161/256) */
 1.5505848776849999591e+00,     /* 2 ** (162/256) */
 1.5547889397770885721e+00,     /* 2 ** (163/256) */
 1.5590044002378369670e+00,     /* 2 ** (164/256) */
 1.5632312899713577041e+00,     /* 2 ** (165/256) */
 1.5674696399655528931e+00,     /* 2 ** (166/256) */
 1.5717194812923413692e+00,     /* 2 ** (167/256) */
 1.5759808451078864865e+00,     /* 2 ** (168/256) */
 1.5802537626528245268e+00,     /* 2 ** (169/256) */
 1.5845382652524937301e+00,     /* 2 ** (170/256) */
 1.5888343843171639442e+00,     /* 2 ** (171/256) */
 1.5931421513422668979e+00,     /* 2 ** (172/256) */
 1.5974615979086270983e+00,     /* 2 ** (173/256) */
 1.6017927556826933538e+00,     /* 2 ** (174/256) */
 1.6061356564167709257e+00,     /* 2 ** (175/256) */
 1.6104903319492543082e+00,     /* 2 ** (176/256) */
 1.6148568142048606401e+00,     /* 2 ** (177/256) */
 1.6192351351948637493e+00,     /* 2 ** (178/256) */
 1.6236253270173288318e+00,     /* 2 ** (179/256) */
 1.6280274218573477668e+00,     /* 2 ** (180/256) */
 1.6324414519872750703e+00,     /* 2 ** (181/256) */
 1.6368674497669644878e+00,     /* 2 ** (182/256) */
 1.6413054476440062287e+00,     /* 2 ** (183/256) */
 1.6457554781539648445e+00,     /* 2 ** (184/256) */
 1.6502175739206177510e+00,     /* 2 ** (185/256) */
 1.6546917676561943976e+00,     /* 2 ** (186/256) */
 1.6591780921616160854e+00,     /* 2 ** (187/256) */
 1.6636765803267364350e+00,     /* 2 ** (188/256) */
 1.6681872651305825067e+00,     /* 2 ** (189/256) */
 1.6727101796415965736e+00,     /* 2 ** (190/256) */
 1.6772453570178785518e+00,     /* 2 ** (191/256) */
 1.6817928305074290861e+00,     /* 2 ** (192/256) */
 1.6863526334483932959e+00,     /* 2 ** (193/256) */
 1.6909247992693051820e+00,     /* 2 ** (194/256) */
 1.6955093614893326950e+00,     /* 2 ** (195/256) */
 1.7001063537185234695e+00,     /* 2 ** (196/256) */
 1.7047158096580512237e+00,     /* 2 ** (197/256) */
 1.7093377631004628271e+00,     /* 2 ** (198/256) */
 1.7139722479299260386e+00,     /* 2 ** (199/256) */
 1.7186192981224779156e+00,     /* 2 ** (200/256) */
 1.7232789477462738972e+00,     /* 2 ** (201/256) */
 1.7279512309618375622e+00,     /* 2 ** (202/256) */
 1.7326361820223110649e+00,     /* 2 ** (203/256) */
 1.7373338352737062490e+00,     /* 2 ** (204/256) */
 1.7420442251551564435e+00,     /* 2 ** (205/256) */
 1.7467673861991689401e+00,     /* 2 ** (206/256) */
 1.7515033530318781561e+00,     /* 2 ** (207/256) */
 1.7562521603732994831e+00,     /* 2 ** (208/256) */
 1.7610138430375838242e+00,     /* 2 ** (209/256) */
 1.7657884359332728210e+00,     /* 2 ** (210/256) */
 1.7705759740635547735e+00,     /* 2 ** (211/256) */
 1.7753764925265212526e+00,     /* 2 ** (212/256) */
 1.7801900265154244090e+00,     /* 2 ** (213/256) */
 1.7850166113189349801e+00,     /* 2 ** (214/256) */
 1.7898562823214009960e+00,     /* 2 ** (215/256) */
 1.7947090750031071864e+00,     /* 2 ** (216/256) */
 1.7995750249405350921e+00,     /* 2 ** (217/256) */
 1.8044541678066238803e+00,     /* 2 ** (218/256) */
 1.8093465393710318685e+00,     /* 2 ** (219/256) */
 1.8142521755003987562e+00,     /* 2 ** (220/256) */
 1.8191711121586085683e+00,     /* 2 ** (221/256) */
 1.8241033854070533110e+00,     /* 2 ** (222/256) */
 1.8290490314048973431e+00,     /* 2 ** (223/256) */
 1.8340080864093424635e+00,     /* 2 ** (224/256) */
 1.8389805867758937177e+00,     /* 2 ** (225/256) */
 1.8439665689586259251e+00,     /* 2 ** (226/256) */
 1.8489660695104509284e+00,     /* 2 ** (227/256) */
 1.8539791250833855684e+00,     /* 2 ** (228/256) */
 1.8590057724288203846e+00,     /* 2 ** (229/256) */
 1.8640460483977890448e+00,     /* 2 ** (230/256) */
 1.8690999899412385049e+00,     /* 2 ** (231/256) */
 1.8741676341102999013e+00,     /* 2 ** (232/256) */
 1.8792490180565601780e+00,     /* 2 ** (233/256) */
 1.8843441790323344497e+00,     /* 2 ** (234/256) */
 1.8894531543909391035e+00,     /* 2 ** (235/256) */
 1.8945759815869656413e+00,     /* 2 ** (236/256) */
 1.8997126981765552647e+00,     /* 2 ** (237/256) */
 1.9048633418176742037e+00,     /* 2 ** (238/256) */
 1.9100279502703897924e+00,     /* 2 ** (239/256) */
 1.9152065613971472939e+00,     /* 2 ** (240/256) */
 1.9203992131630474739e+00,     /* 2 ** (241/256) */
 1.9256059436361249290e+00,     /* 2 ** (242/256) */
 1.9308267909876271679e+00,     /* 2 ** (243/256) */
 1.9360617934922944506e+00,     /* 2 ** (244/256) */
 1.9413109895286403852e+00,     /* 2 ** (245/256) */
 1.9465744175792332863e+00,     /* 2 ** (246/256) */
 1.9518521162309782959e+00,     /* 2 ** (247/256) */
 1.9571441241754002690e+00,     /* 2 ** (248/256) */
 1.9624504802089274268e+00,     /* 2 ** (249/256) */
 1.9677712232331757781e+00,     /* 2 ** (250/256) */
 1.9731063922552343129e+00,     /* 2 ** (251/256) */
 1.9784560263879509683e+00,     /* 2 ** (252/256) */
 1.9838201648502193699e+00,     /* 2 ** (253/256) */
 1.9891988469672663513e+00,     /* 2 ** (254/256) */
 1.9945921121709402525e+00};    /* 2 ** (255/256) */
